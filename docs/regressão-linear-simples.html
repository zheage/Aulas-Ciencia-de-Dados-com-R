<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 10 Regressão Linear Simples | CIÊNCIA DE DADOS COM LINGUAGEM R</title>
  <meta name="description" content="<p>#This is a minimal example of using the bookdown package to write a book.
#The HTML output format for this example is bookdown::gitbook,
#set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 10 Regressão Linear Simples | CIÊNCIA DE DADOS COM LINGUAGEM R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>#This is a minimal example of using the bookdown package to write a book.
#The HTML output format for this example is bookdown::gitbook,
#set in the _output.yml file.</p>" />
  <meta name="github-repo" content="https://zheage.github.io/Aulas-Ciencia-de-Dados-com-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 10 Regressão Linear Simples | CIÊNCIA DE DADOS COM LINGUAGEM R" />
  
  <meta name="twitter:description" content="<p>#This is a minimal example of using the bookdown package to write a book.
#The HTML output format for this example is bookdown::gitbook,
#set in the _output.yml file.</p>" />
  

<meta name="author" content="Richard Guilherme dos Santos" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introdução-ao-machine-learning.html"/>
<link rel="next" href="regressão-linear-múltipla.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a>Ciência de Dados com R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introdução.html"><a href="introdução.html"><i class="fa fa-check"></i><b>1</b> Introdução</a></li>
<li class="chapter" data-level="2" data-path="dados-utilizados.html"><a href="dados-utilizados.html"><i class="fa fa-check"></i><b>2</b> Dados Utilizados</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dados-utilizados.html"><a href="dados-utilizados.html#motor-trend-car-road-test-mtcars"><i class="fa fa-check"></i><b>2.1</b> Motor Trend Car Road Test (mtcars)</a></li>
<li class="chapter" data-level="2.2" data-path="dados-utilizados.html"><a href="dados-utilizados.html#pokémons-dataset"><i class="fa fa-check"></i><b>2.2</b> Pokémons Dataset</a></li>
<li class="chapter" data-level="2.3" data-path="dados-utilizados.html"><a href="dados-utilizados.html#fifa-2022-player-dataset"><i class="fa fa-check"></i><b>2.3</b> Fifa 2022 Player Dataset</a></li>
</ul></li>
<li class="part"><span><b>I Análise de Dados</b></span></li>
<li class="chapter" data-level="3" data-path="introdução-ao-r.html"><a href="introdução-ao-r.html"><i class="fa fa-check"></i><b>3</b> Introdução ao R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introdução-ao-r.html"><a href="introdução-ao-r.html#introdução-a-fatores"><i class="fa fa-check"></i><b>3.1</b> Introdução a Fatores</a></li>
<li class="chapter" data-level="3.2" data-path="introdução-ao-r.html"><a href="introdução-ao-r.html#trabalhando-com-datas"><i class="fa fa-check"></i><b>3.2</b> Trabalhando com Datas</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html"><i class="fa fa-check"></i><b>4</b> Medidas Descritivas</a>
<ul>
<li class="chapter" data-level="4.1" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#tipos-de-variáveis"><i class="fa fa-check"></i><b>4.1</b> Tipos de Variáveis</a></li>
<li class="chapter" data-level="4.2" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#medidas-de-posição"><i class="fa fa-check"></i><b>4.2</b> Medidas de Posição</a></li>
<li class="chapter" data-level="4.3" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#medidas-de-dispersão"><i class="fa fa-check"></i><b>4.3</b> Medidas de Dispersão</a></li>
<li class="chapter" data-level="4.4" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#quantis-empíricos"><i class="fa fa-check"></i><b>4.4</b> Quantis Empíricos</a></li>
<li class="chapter" data-level="4.5" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#box-plot"><i class="fa fa-check"></i><b>4.5</b> Box Plot</a></li>
<li class="chapter" data-level="4.6" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#transformações"><i class="fa fa-check"></i><b>4.6</b> Transformações</a></li>
<li class="chapter" data-level="4.7" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#lab-01---conjunto-de-dados-iris"><i class="fa fa-check"></i><b>4.7</b> Lab 01 - Conjunto de dados Iris</a></li>
<li class="chapter" data-level="4.8" data-path="medidas-descritivas.html"><a href="medidas-descritivas.html#lab-02---xadrez-brasil"><i class="fa fa-check"></i><b>4.8</b> Lab 02 - Xadrez Brasil</a></li>
</ul></li>
<li class="part"><span><b>II Tidyverse</b></span></li>
<li class="chapter" data-level="5" data-path="introdução-ao-tidyverse.html"><a href="introdução-ao-tidyverse.html"><i class="fa fa-check"></i><b>5</b> Introdução ao Tidyverse</a></li>
<li class="chapter" data-level="6" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>6</b> Readr</a></li>
<li class="chapter" data-level="7" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html"><i class="fa fa-check"></i><b>7</b> Dplyr &amp; Tidyr</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#extração-de-observações-linhas"><i class="fa fa-check"></i><b>7.1</b> Extração de Observações (Linhas)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#filter"><i class="fa fa-check"></i><b>7.1.1</b> filter</a></li>
<li class="chapter" data-level="7.1.2" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#distinct"><i class="fa fa-check"></i><b>7.1.2</b> distinct</a></li>
<li class="chapter" data-level="7.1.3" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#operador-pipe"><i class="fa fa-check"></i><b>7.1.3</b> Operador Pipe</a></li>
<li class="chapter" data-level="7.1.4" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#sample_frac"><i class="fa fa-check"></i><b>7.1.4</b> sample_frac</a></li>
<li class="chapter" data-level="7.1.5" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#slice"><i class="fa fa-check"></i><b>7.1.5</b> slice</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#extração-de-variáveis-colunas"><i class="fa fa-check"></i><b>7.2</b> Extração de Variáveis (Colunas)</a></li>
<li class="chapter" data-level="7.3" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#resumir-dados"><i class="fa fa-check"></i><b>7.3</b> Resumir dados</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#summarise"><i class="fa fa-check"></i><b>7.3.1</b> summarise</a></li>
<li class="chapter" data-level="7.3.2" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#summarise_each"><i class="fa fa-check"></i><b>7.3.2</b> summarise_each</a></li>
<li class="chapter" data-level="7.3.3" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#count"><i class="fa fa-check"></i><b>7.3.3</b> count</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#criação-de-novas-variáveis"><i class="fa fa-check"></i><b>7.4</b> Criação de Novas Variáveis</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#mutate"><i class="fa fa-check"></i><b>7.4.1</b> mutate</a></li>
<li class="chapter" data-level="7.4.2" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#transmute"><i class="fa fa-check"></i><b>7.4.2</b> transmute</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#combinar-conjuntos-de-dados"><i class="fa fa-check"></i><b>7.5</b> Combinar Conjuntos de Dados</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#left_join"><i class="fa fa-check"></i><b>7.5.1</b> left_join</a></li>
<li class="chapter" data-level="7.5.2" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#inner_join"><i class="fa fa-check"></i><b>7.5.2</b> inner_join</a></li>
<li class="chapter" data-level="7.5.3" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#full_join"><i class="fa fa-check"></i><b>7.5.3</b> full_join</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#agrupar-dados-group_by"><i class="fa fa-check"></i><b>7.6</b> Agrupar Dados (group_by)</a></li>
<li class="chapter" data-level="7.7" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#remodelando-dados"><i class="fa fa-check"></i><b>7.7</b> Remodelando Dados</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#arrange"><i class="fa fa-check"></i><b>7.7.1</b> arrange</a></li>
<li class="chapter" data-level="7.7.2" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#rename"><i class="fa fa-check"></i><b>7.7.2</b> rename</a></li>
<li class="chapter" data-level="7.7.3" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#separate"><i class="fa fa-check"></i><b>7.7.3</b> separate</a></li>
<li class="chapter" data-level="7.7.4" data-path="dplyr-tidyr.html"><a href="dplyr-tidyr.html#unite"><i class="fa fa-check"></i><b>7.7.4</b> unite</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>8</b> GGPlot2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ggplot2.html"><a href="ggplot2.html#diagrama-de-dispersão-geom_point"><i class="fa fa-check"></i><b>8.1</b> Diagrama de Dispersão (geom_point)</a></li>
<li class="chapter" data-level="8.2" data-path="ggplot2.html"><a href="ggplot2.html#centralizando-o-título-de-gráficos"><i class="fa fa-check"></i><b>8.2</b> Centralizando o Título de Gráficos</a></li>
<li class="chapter" data-level="8.3" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-barras-geom_bar-e-geom_col"><i class="fa fa-check"></i><b>8.3</b> Gráficos de Barras (geom_bar e geom_col)</a></li>
<li class="chapter" data-level="8.4" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-linhas-geom_line"><i class="fa fa-check"></i><b>8.4</b> Gráficos de Linhas (geom_line)</a></li>
<li class="chapter" data-level="8.5" data-path="ggplot2.html"><a href="ggplot2.html#gráfico-de-funções-stat_function"><i class="fa fa-check"></i><b>8.5</b> Gráfico de Funções (stat_function)</a></li>
<li class="chapter" data-level="8.6" data-path="ggplot2.html"><a href="ggplot2.html#histogramas-geom_histogram"><i class="fa fa-check"></i><b>8.6</b> Histogramas (geom_histogram)</a></li>
<li class="chapter" data-level="8.7" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-geom_boxplot"><i class="fa fa-check"></i><b>8.7</b> Boxplots (geom_boxplot)</a></li>
<li class="chapter" data-level="8.8" data-path="ggplot2.html"><a href="ggplot2.html#facets-facet_grid"><i class="fa fa-check"></i><b>8.8</b> Facets (facet_grid)</a></li>
<li class="chapter" data-level="8.9" data-path="ggplot2.html"><a href="ggplot2.html#bibliotecas-auxiliares"><i class="fa fa-check"></i><b>8.9</b> Bibliotecas Auxiliares</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="ggplot2.html"><a href="ggplot2.html#cowplot"><i class="fa fa-check"></i><b>8.9.1</b> cowplot</a></li>
<li class="chapter" data-level="8.9.2" data-path="ggplot2.html"><a href="ggplot2.html#ggally"><i class="fa fa-check"></i><b>8.9.2</b> GGally</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Machine Learning</b></span></li>
<li class="chapter" data-level="9" data-path="introdução-ao-machine-learning.html"><a href="introdução-ao-machine-learning.html"><i class="fa fa-check"></i><b>9</b> Introdução ao Machine Learning</a></li>
<li class="chapter" data-level="10" data-path="regressão-linear-simples.html"><a href="regressão-linear-simples.html"><i class="fa fa-check"></i><b>10</b> Regressão Linear Simples</a>
<ul>
<li class="chapter" data-level="10.1" data-path="regressão-linear-simples.html"><a href="regressão-linear-simples.html#criando-o-modelo-estimando-seus-coeficientes"><i class="fa fa-check"></i><b>10.1</b> Criando o Modelo &amp; Estimando Seus Coeficientes</a></li>
<li class="chapter" data-level="10.2" data-path="regressão-linear-simples.html"><a href="regressão-linear-simples.html#a-poeira-debaixo-do-tapete"><i class="fa fa-check"></i><b>10.2</b> A Poeira Debaixo do Tapete</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="regressão-linear-simples.html"><a href="regressão-linear-simples.html#linearidade-nos-dados"><i class="fa fa-check"></i><b>10.2.1</b> Linearidade nos Dados</a></li>
<li class="chapter" data-level="10.2.2" data-path="regressão-linear-simples.html"><a href="regressão-linear-simples.html#normalidade-dos-erros"><i class="fa fa-check"></i><b>10.2.2</b> Normalidade dos Erros</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="regressão-linear-simples.html"><a href="regressão-linear-simples.html#boas-práticas-para-modelagem"><i class="fa fa-check"></i><b>10.3</b> Boas Práticas Para Modelagem</a></li>
<li class="chapter" data-level="10.4" data-path="regressão-linear-simples.html"><a href="regressão-linear-simples.html#lidando-com-dados-categóricos"><i class="fa fa-check"></i><b>10.4</b> Lidando com Dados Categóricos</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regressão-linear-múltipla.html"><a href="regressão-linear-múltipla.html"><i class="fa fa-check"></i><b>11</b> Regressão Linear Múltipla</a></li>
<li class="chapter" data-level="12" data-path="regressão-logística.html"><a href="regressão-logística.html"><i class="fa fa-check"></i><b>12</b> Regressão Logística</a></li>
<li class="part"><span><b>IV Projetos</b></span></li>
<li class="chapter" data-level="13" data-path="machine-learning-from-disaster.html"><a href="machine-learning-from-disaster.html"><i class="fa fa-check"></i><b>13</b> Machine Learning from Disaster</a></li>
<li class="divider"></li>
<li><a href="https://www.linkedin.com/in/richard-guilherme-da/" target="blank">Richard Guilherme</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CIÊNCIA DE DADOS COM LINGUAGEM R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regressão-linear-simples" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Capítulo 10</span> Regressão Linear Simples<a href="regressão-linear-simples.html#regressão-linear-simples" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Em problemas de <strong>aprendizagem supervisionada</strong> regressão linear é um dos algoritmo que inicialmente trabalhamos, pela sua praticidade em extrair informações entre as covariáveis para gerar insights e ser de fácil visualização.</p>
<p>Consideremos uma variável resposta <span class="math inline">\(Y\)</span> através de uma variável preditora <span class="math inline">\(X\)</span>. No contexto da regressão nós assumimos que exista uma <strong>relação linear</strong> entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, qual pode ser escrita da seguinte forma</p>
<p><span class="math display">\[
Y \approx \beta_0 + \beta_1 X.
\]</span></p>
<p>Onde <span class="math inline">\(\approx\)</span> significa que <span class="math inline">\(Y\)</span> é aproximadamente uma soma linear de <span class="math inline">\(X\)</span>. Como exemplo, no conjunto mtcars <span class="math inline">\(Y\)</span> pode ser a variável <code>mpg(minhas por galão)</code> enquanto <span class="math inline">\(X\)</span> a variável <code>hp(cavalos de potência)</code>.</p>
<p><span class="math display">\[
\text{mpg} \approx \beta_0 + \beta_1 \text{hp}.
\]</span></p>
<p>Nestas equações os parâmetros <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> são duas constantes desconhecidas que representam o intercepto e o coeficiente angular de uma curva. Chamamos estes de <strong>coeficientes</strong> ou <strong>parâmetros</strong> do modelo de regressão linear.</p>
<div id="criando-o-modelo-estimando-seus-coeficientes" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Criando o Modelo &amp; Estimando Seus Coeficientes<a href="regressão-linear-simples.html#criando-o-modelo-estimando-seus-coeficientes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Na prática os parâmetros do modelo são desconhecidos. Para estíma-los consideremos que temos um conjunto de dados com <span class="math inline">\(n\)</span> linhas:</p>
<p><span class="math display">\[
(x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)
\]</span></p>
<p>Cada um representando um valor para as colunas <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. Nosso objetivo é estimar <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> de modo que o modelo linear realize boas previsões, isto é</p>
<p><span class="math display">\[
y_i \approx \beta_0 + \beta_1x_i, i=1,\dots, n
\]</span></p>
<p>Desta forma estamos interessados na reta que melhor se aproxime aos pontos do conjunto de dados:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="regressão-linear-simples.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb118-2"><a href="regressão-linear-simples.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-103-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Podemos criar visualmente esta reta utilizando o pacote <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="regressão-linear-simples.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb119-2"><a href="regressão-linear-simples.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb119-3"><a href="regressão-linear-simples.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb119-4"><a href="regressão-linear-simples.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Regressão linear no conjunto mtcars&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Podemos utilizar a função <code>lm</code> do próprio <code>R</code> para ajustarmos o modelo:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="regressão-linear-simples.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No primeiro parâmetro temos a relação que queremos pro</span></span>
<span id="cb120-2"><a href="regressão-linear-simples.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># conjunto de dados</span></span>
<span id="cb120-3"><a href="regressão-linear-simples.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Neste caso estamos querendo prever mpg através de hp</span></span>
<span id="cb120-4"><a href="regressão-linear-simples.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># No segundo parâmetro inserimos o conjunto de dados</span></span>
<span id="cb120-5"><a href="regressão-linear-simples.html#cb120-5" aria-hidden="true" tabindex="-1"></a>mtcars_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> mtcars)</span></code></pre></div>
<p>São várias as vantagens de utilizar a função <code>lm</code> - veremos mais adiante como ajustar o modelo com várias conjuntos do banco de dados. Além disso, a função pode realizar previsões em novos conjuntos, além de carregar diversas informações estatísticas importantes:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="regressão-linear-simples.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ hp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7121 -2.1122 -0.8854  1.5819  8.2360 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.09886    1.63392  18.421  &lt; 2e-16 ***
## hp          -0.06823    0.01012  -6.742 1.79e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.863 on 30 degrees of freedom
## Multiple R-squared:  0.6024, Adjusted R-squared:  0.5892 
## F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</code></pre>
<p>As mais importantes de observamos em um primeiro momento são os <strong>coeficientes</strong> estimados da nossa curva, neste caso o modelo ajustado é dado por:</p>
<p><span class="math display">\[
\text{mpg} \approx 30.09886 - 0.06823 \text{hp}.
\]</span></p>
<p>Isto significa que ao acréscimo de 1 cavalo de potência em um carro, neste conjunto de dados, temos <strong>em média</strong> uma diminuição na quantidade de milhas feita por galão, ou seja, o carro acaba gastando mais combustível.</p>
<blockquote>
<p>Mas afinal, qual é a matemática por trás deste problema?</p>
</blockquote>
<p>Apesar de termos funções prontas para realizarmos a modelagem, é importante entender a sua criação, pois diversos conceitos partem desta. Para elaborarmos o modelo utilizamos a <strong>minimização dos mínimos quadrados</strong>.</p>
<p>Para isto partimos do modelo comentado inicialmente:</p>
<p><span class="math display">\[
Y \approx \beta_0 + \beta_1 X.
\]</span></p>
<p>Neste modelo, para cada linha do nosso conjunto de dados, <span class="math inline">\(y_i\)</span>, teremos uma previsão, <span class="math inline">\(\hat{y_i}\)</span>. Chamamos de i-ésimo <strong>resíduo</strong> o erro cometido entre o valor real de uma observação e o valor ajustado do modelo em uma observação:</p>
<p><span class="math display">\[
e_i = y_i - \hat{y_i}
\]</span></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="regressão-linear-simples.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">&#39;hp&#39;</span> <span class="ot">=</span> mtcars<span class="sc">$</span>hp, <span class="st">&#39;mpg&#39;</span> <span class="ot">=</span> mtcars<span class="sc">$</span>mpg, </span>
<span id="cb123-2"><a href="regressão-linear-simples.html#cb123-2" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;fitted&#39;</span> <span class="ot">=</span> mtcars_lm<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb123-3"><a href="regressão-linear-simples.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb123-4"><a href="regressão-linear-simples.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-5"><a href="regressão-linear-simples.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb123-6"><a href="regressão-linear-simples.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg,</span>
<span id="cb123-7"><a href="regressão-linear-simples.html#cb123-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> hp, <span class="at">yend =</span> fitted)) <span class="sc">+</span></span>
<span id="cb123-8"><a href="regressão-linear-simples.html#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Regressão linear no conjunto mtcars&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Definimos como <strong>soma dos quadrados dos resíduos</strong> o valor</p>
<p><span class="math display">\[
\text{RSS} = e_1^2+e_2^2+\dots + e_n^2,
\]</span></p>
<p>Estamos interessados na reta que tenha a menor soma dos quadrados dos resíduos. Para avançarmos nesta procura, relembremos que se denotarmos <span class="math inline">\(\hat{y_i}\)</span> como sendo a previsão do modelo para i-ésima observação, então:</p>
<p><span class="math display">\[
\hat{y_i} = \beta_0 + \beta_1 x_i, i =1,\dots, n
\]</span></p>
<p>Assim, podemos reescrever os resíduos da seguinte maneira:</p>
<p><span class="math display">\[
\text{RSS} = (y_1- \beta_0-\hat{\beta_1}x_1)^2 + (y_2- \beta_0-\hat{\beta_1}x_2)^2 +\cdots + (y_n- \beta_0-\hat{\beta_1}x_n)^2
\]</span></p>
<p>Assim, para criar o modelo basta considerarmo <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span> que minimizem esta soma. Isto é facilmente resolvido com conceitos de Cálculo 1, onde os melhores parâmetros são:</p>
<p><span class="math display">\[
\hat{\beta_1} = \dfrac{\sum_{i=1}^n (x_i - \overline{x})(y_i- \overline{y})}{\sum_{i=1}^n (x_i-\overline{x})^2}, \quad \hat{\beta_0}=\overline{y} - \hat{\beta_1}\overline{x}.
\]</span></p>
<blockquote>
<p><strong>IMPORTANTE:</strong> Aqui não precisamos entender diretamente como a fórmula dos parâmetros é encontrada, mas sim o objetivo para chegarmos até essa fórmula.</p>
<p>Não é importante lembrar a fórmula para encontrar os parâmetros, mas sim que a reta é encontrada de forma a minimizarmos a <strong>soma dos quadrados dos resíduos.</strong></p>
</blockquote>
<p>Podemos então realizarmos a nossa própria função para obter o nosso modelo de regressão:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="regressão-linear-simples.html#cb124-1" aria-hidden="true" tabindex="-1"></a>linear_regression <span class="ot">&lt;-</span> <span class="cf">function</span>(X, Y){</span>
<span id="cb124-2"><a href="regressão-linear-simples.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  numerador <span class="ot">=</span> <span class="fu">sum</span>((X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">*</span> (Y <span class="sc">-</span> <span class="fu">mean</span>(Y)))</span>
<span id="cb124-3"><a href="regressão-linear-simples.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  denominador <span class="ot">=</span> <span class="fu">sum</span>((X <span class="sc">-</span> <span class="fu">mean</span>(X))<span class="sc">**</span><span class="dv">2</span>) </span>
<span id="cb124-4"><a href="regressão-linear-simples.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  beta_1 <span class="ot">=</span> numerador<span class="sc">/</span>denominador</span>
<span id="cb124-5"><a href="regressão-linear-simples.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  beta_0 <span class="ot">=</span> <span class="fu">mean</span>(Y) <span class="sc">-</span> beta_1 <span class="sc">*</span> <span class="fu">mean</span>(X)</span>
<span id="cb124-6"><a href="regressão-linear-simples.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="st">&#39;beta_0&#39;</span> <span class="ot">=</span> beta_0,</span>
<span id="cb124-7"><a href="regressão-linear-simples.html#cb124-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;beta_1&#39;</span> <span class="ot">=</span> beta_1))</span>
<span id="cb124-8"><a href="regressão-linear-simples.html#cb124-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-9"><a href="regressão-linear-simples.html#cb124-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-10"><a href="regressão-linear-simples.html#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_regression</span>(<span class="at">X =</span> mtcars<span class="sc">$</span>hp, <span class="at">Y =</span> mtcars<span class="sc">$</span>mpg)</span></code></pre></div>
<pre><code>##     beta_0      beta_1
## 1 30.09886 -0.06822828</code></pre>
</div>
<div id="a-poeira-debaixo-do-tapete" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> A Poeira Debaixo do Tapete<a href="regressão-linear-simples.html#a-poeira-debaixo-do-tapete" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A elaboração de um modelo de regressão linear é extremamente simples. Porém, existem diversas condições para a criação deste modelo. Estas condições são <strong>teóricas</strong> e não irão acarretar em um erro na hora de executar o script no <code>R</code>, porém podem acarretar em erro de interpretação e previsão para dados futuros.</p>
<p>As 3 condições que devemos ter para um modelo de regressão linear são:</p>
<ol style="list-style-type: decimal">
<li><strong>Linearidade nos dados;</strong></li>
<li><strong>Erros normalmente distribuídos;</strong></li>
<li><strong>Erros com variância igual (Homocedasticidade).</strong></li>
</ol>
<div id="linearidade-nos-dados" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Linearidade nos Dados<a href="regressão-linear-simples.html#linearidade-nos-dados" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linearidade é a hipótese de que de fato há uma relação linear entre os dados para que o modelo esteja bem ajustado, considere o seguinte exemplo:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="regressão-linear-simples.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(regressao_nao_linear, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb126-2"><a href="regressão-linear-simples.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb126-3"><a href="regressão-linear-simples.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">formula =</span> <span class="st">&#39;y ~ x&#39;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb126-4"><a href="regressão-linear-simples.html#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Pontos que não possuem relação linear&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-109-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>É evidente que a reta ajustada aqui é <strong>péssima.</strong> Para resolvermos este problema, neste exemplo em específico, podemos particionar o conjunto de dados em dois: um para valores positivos de <span class="math inline">\(X\)</span> e outro para negativos.</p>
<p>Não há uma única maneira para lidar com a não linearidade dos dados, em <strong>regressão linear múltipla</strong>, onde utilizamos mais de uma coluna para prever a variável resposta podemos realizar operações de forma a lidar com a falta de linearidade dos dados:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="regressão-linear-simples.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilização das colunas X e X^2 para a reta de regressão linear:</span></span>
<span id="cb127-2"><a href="regressão-linear-simples.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(regressao_nao_linear, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb127-3"><a href="regressão-linear-simples.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb127-4"><a href="regressão-linear-simples.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">formula =</span> <span class="st">&#39;y ~ x + I(x^2)&#39;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb127-5"><a href="regressão-linear-simples.html#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Pontos que não possuem relação linear&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-110-1.png" width="672" style="display: block; margin: auto;" /></p>
<blockquote>
<p><strong>IMPORTANTE:</strong> Regressão Linear possui este nome pela <strong>linearidade em seus coeficientes</strong>, no exemplo acima temos o seguinte modelo:</p>
<p><span class="math display">\[
Y = 0.0009678 -0.0032584 X + 0.9931674 X^2
\]</span></p>
<p>Assim, apesar de utilizarmos os elementos de uma coluna ao quadrado, os parâmetros estimados estão no modelo de forma linear:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + \beta_2 X^2
\]</span></p>
<p>veremos mais sobre isso em regressão linear múltipla.</p>
</blockquote>
<div id="coeficiente-de-correlação-de-pearson" class="section level4 hasAnchor" number="10.2.1.1">
<h4><span class="header-section-number">10.2.1.1</span> Coeficiente de Correlação de Pearson<a href="regressão-linear-simples.html#coeficiente-de-correlação-de-pearson" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Podemos exprimir a relação linear entre duas colunas em um valor numérico, qual é de mais fácil interpretação quando estamos lidando com várias colunas ao mesmo tempo.</p>
<ul>
<li>Definimos <strong>coeficiente de correlação de Pearson</strong> entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> o valor</li>
</ul>
<p><span class="math display">\[
R = \dfrac{\sum_{i=1}^n (x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum_{i=1}^n (x_i-\overline{x})^2 \sum_{i=1}^n (y_i-\overline{y})^2}}.
\]</span></p>
<p>Qual possui as seguintes propriedades:</p>
<ol style="list-style-type: decimal">
<li>Descreve o quão forte é a relação linear entre duas variáveis;</li>
<li>O sinal da correlação indica a direção da associação;</li>
<li>Sempre varia de -1 a 1;</li>
<li>Não é afetado por mudança na escala das variáveis;</li>
<li>É sensível a <strong>outliers.</strong></li>
</ol>
<p><img src="_main_files/figure-html/unnamed-chunk-111-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Existem várias formas de observar a correlação entre colunas do conjunto de dados, uma que me agrada é a função <code>ggpairs</code> do pacote <code>GGally</code>:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="regressão-linear-simples.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(mtcars[<span class="fu">c</span>(<span class="st">&#39;hp&#39;</span>, <span class="st">&#39;mpg&#39;</span>)])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-112-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="normalidade-dos-erros" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Normalidade dos Erros<a href="regressão-linear-simples.html#normalidade-dos-erros" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Quando criamos o modelo</p>
<p><span class="math display">\[
Y \approx \beta_0 + \beta_1 X.
\]</span></p>
<p>normalmente assumimos que a aproximação pode ser corrigida por uma variável aleatória <span class="math inline">\(\varepsilon\)</span> que possui <strong>distribuição normal</strong>, isto é:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X +\varepsilon.
\]</span></p>
<p>Em outras palavras, o erro de medição possui distribuição normal.</p>
<blockquote>
<p><strong>Mas afinal, o que é distribuição é uma distribuição? e mais ainda, o que tem de importante dela ser normal?</strong></p>
</blockquote>
<p>Sendo bem superficiais, tipos de distribuições surgem da forma em que os dados são distribuídos. Em particular, a distribuição normal é importante pois aparece em diversos problemas reais, além de possuir ótimas propriedades matemáticas.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-113-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Dentre estas estamos interessados que:</p>
<ul>
<li><p><strong>A média/mediana dos nossos erros seja 0</strong> - a aleatoridade deve acontecer tanto de forma que estejamos superestimando e subestimando a variável <span class="math inline">\(Y\)</span>;</p></li>
<li><p><strong>Homocedasticidade: os erros variem de forma igual</strong> - a aleatoridade de cada medição varia dentro de um alcance, imagine errar o peso de pessoas por gramas e depois começar a termos erros na escala de kg no mesmo conjunto de dados.</p></li>
</ul>
<p>Existem diversas formas para confirmar a normalidade dos erros, assim como a <strong>homocedasticidade:</strong></p>
<ul>
<li><strong>Histograma da variável resposta:</strong> Maneira inicial, quando assumimos que os resíduos possuem distribuição normal temos, como consequência, a normalidade da variável resposta que estamos tentando prever, qual pode ser observada pelo seu histograma:</li>
</ul>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="regressão-linear-simples.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> mpg)) <span class="sc">+</span></span>
<span id="cb129-2"><a href="regressão-linear-simples.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>,</span>
<span id="cb129-3"><a href="regressão-linear-simples.html#cb129-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-114-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li><strong>Histograma dos resíduos:</strong> maneira mais intuitiva, observamos se o histograma dos resíduos possuí comportamento normal</li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="regressão-linear-simples.html#cb130-1" aria-hidden="true" tabindex="-1"></a>mtcars_residuos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">resid =</span> mtcars_lm<span class="sc">$</span>residuals)</span>
<span id="cb130-2"><a href="regressão-linear-simples.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars_residuos, <span class="fu">aes</span>(<span class="at">x =</span> resid)) <span class="sc">+</span></span>
<span id="cb130-3"><a href="regressão-linear-simples.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-115-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li><strong>Q-Q Plot:</strong> Gráfico que compara os quantis de uma amostra com os de uma distribuição de interesse, para que a hipótese se sustente os pontos devem estar próximos da reta identidade:</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="regressão-linear-simples.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars_residuos, <span class="fu">aes</span>(<span class="at">sample =</span> resid)) <span class="sc">+</span></span>
<span id="cb131-2"><a href="regressão-linear-simples.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb131-3"><a href="regressão-linear-simples.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb131-4"><a href="regressão-linear-simples.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Teórico&#39;</span>) <span class="sc">+</span> </span>
<span id="cb131-5"><a href="regressão-linear-simples.html#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Amostral&#39;</span>) <span class="sc">+</span></span>
<span id="cb131-6"><a href="regressão-linear-simples.html#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Q-Q Plot&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-116-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li><p><strong>Testes de Hipótese:</strong> é um conceito da inferência estatística, nele confrontramos duas hipóteses e então elaboramos um teste para testá-las. No nosso contexto as hipóteses a serem consideradas são:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span> (Hipótese nula): A distribuição dos dados é normal;</p></li>
<li><p><span class="math inline">\(H_1\)</span> (Hipótese alternativa): A distribuição dos dados não é normal.</p></li>
</ul></li>
</ul>
<p>Cada teste possui duas informações: uma estatística, número que representa um valor de referência a uma distribuição e, mais importante, um <strong>p-valor</strong>, qual representa a probabilidade de obtermos a amostra da distribuição caso consideremos a hipótese nula como verdadeira:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="regressão-linear-simples.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest) <span class="co"># Testes de Normalidade</span></span>
<span id="cb132-2"><a href="regressão-linear-simples.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mtcars_residuos<span class="sc">$</span>resid) <span class="co"># Shapiro-Wilk</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  mtcars_residuos$resid
## W = 0.92337, p-value = 0.02568</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="regressão-linear-simples.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cvm.test</span>(mtcars_residuos<span class="sc">$</span>resid) <span class="co"># Cramer-von Mises</span></span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises normality test
## 
## data:  mtcars_residuos$resid
## W = 0.11828, p-value = 0.05976</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="regressão-linear-simples.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(mtcars_residuos<span class="sc">$</span>resid) <span class="co"># Lilliefors</span></span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  mtcars_residuos$resid
## D = 0.11669, p-value = 0.3257</code></pre>
<p>Rejeitamos a hipótese nula caso o p-valor esteja abaixo de <span class="math inline">\(0.1,0.05\)</span> ou <span class="math inline">\(0.01\)</span>.</p>
<blockquote>
<p><strong>IMPORTANTE:</strong> a definição formal de <strong>p-valor</strong> é a probabilidade de que a estatística seja igual ou maior do que a encontrada, e é um pouco mais abstrata. Caso forem estudar sobre testes de hipótese, não se assuste com outras terminologias.</p>
</blockquote>
<ul>
<li><strong>Gráfico de covaríaveis x resíduos:</strong> Importante para visualizar se os resíduos possuem a mesma variância. Caso isto seja verdadeiro, os pontos estão dentro de um “retângulo imaginário” dentro do eixo y, caso contrário temos gráficos em forma de funil.</li>
</ul>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="regressão-linear-simples.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">&#39;hp&#39;</span> <span class="ot">=</span> mtcars<span class="sc">$</span>hp, </span>
<span id="cb138-2"><a href="regressão-linear-simples.html#cb138-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">&#39;resid&#39;</span> <span class="ot">=</span> mtcars_residuos<span class="sc">$</span>resid) <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="regressão-linear-simples.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb138-4"><a href="regressão-linear-simples.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-5"><a href="regressão-linear-simples.html#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb138-6"><a href="regressão-linear-simples.html#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;HP vs Resíduos&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-118-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Vejamos um caso onde a variância para ambos os conjuntos é diferente:</p>
<p><a href="https://gallery.shinyapps.io/slr_diag/" class="uri">https://gallery.shinyapps.io/slr_diag/</a></p>
</div>
</div>
<div id="boas-práticas-para-modelagem" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Boas Práticas Para Modelagem<a href="regressão-linear-simples.html#boas-práticas-para-modelagem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Muitas vezes quando ajustamos o modelo acabamos por realizar extrapolações que não possuem base nos dados utilizados. As mais comuns são:</p>
<ul>
<li><strong>Realizar previsões onde não temos dados:</strong> Vamos utilizar o exemplo do <code>mtcars</code>.</li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-119-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A base <code>mtcars</code> é extraída da revista <em>Motor Trend US</em> de 1974. Imagine que utilizemos este conjunto para realizar previsões de carros de hoje em dia, parece um pouco absurdo, não?</p>
<p>Assim, é importante termos cuidado da região e período dos nossos dados, uma vez que diversas alterações acontecem ao decorrer do tempo e nosso modelo estaria desatualizado para análises com carros da atualidade.</p>
<p>Outro tipo de extrapolação, também neste mesmo tópico é em realizar previsões fora do alcance do modelo. Vamos imaginar que estejamos interessados em realizar previsões sobre carros com 800, 900 ou até 1000 cavalos de potência. Nosso modelo foi ajustado entre carros com 50 a 350 cavalos de potência - nada sabemos se a relação de linearidade dos dados, normalidade e homocedasticidade dos resíduos irá permanecer para dados neste alcance.</p>
</div>
<div id="lidando-com-dados-categóricos" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Lidando com Dados Categóricos<a href="regressão-linear-simples.html#lidando-com-dados-categóricos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Também podemos utilizar <strong>dados categóricos</strong> para a elaboração de um modelo de regressão. Aqui perdemos um pouco a noção geométrica do modelo, mas ainda sim este pode ser elaborado.</p>
<p>Vamos carregar um conjunto de dados <em>criado</em> <em>artificialmente</em> de cargo de cientistas de dados e seus respectivos salários chamado <code>cat_lm</code>:</p>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Cargo"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Salario"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Pleno","2":"2997.914"},{"1":"Pleno","2":"3004.894"},{"1":"Pleno","2":"3000.616"},{"1":"Junior","2":"1996.927"},{"1":"Pleno","2":"3007.962"},{"1":"Senior","2":"3996.430"},{"1":"Pleno","2":"2993.837"},{"1":"Pleno","2":"3002.632"},{"1":"Junior","2":"1999.628"},{"1":"Junior","2":"2002.985"},{"1":"Pleno","2":"2991.309"},{"1":"Junior","2":"1990.952"},{"1":"Senior","2":"3999.948"},{"1":"Pleno","2":"3000.548"},{"1":"Pleno","2":"3003.253"},{"1":"Pleno","2":"2998.051"},{"1":"Junior","2":"1993.501"},{"1":"Pleno","2":"2999.544"},{"1":"Junior","2":"1992.771"},{"1":"Pleno","2":"3007.738"},{"1":"Junior","2":"2012.906"},{"1":"Pleno","2":"2996.525"},{"1":"Junior","2":"1997.007"},{"1":"Pleno","2":"3003.021"},{"1":"Pleno","2":"2991.045"},{"1":"Junior","2":"1991.444"},{"1":"Senior","2":"4010.135"},{"1":"Pleno","2":"2997.335"},{"1":"Pleno","2":"2990.528"},{"1":"Junior","2":"1992.105"},{"1":"Junior","2":"1994.878"},{"1":"Pleno","2":"3001.357"},{"1":"Pleno","2":"2999.030"},{"1":"Junior","2":"1996.375"},{"1":"Pleno","2":"3003.710"},{"1":"Junior","2":"1996.769"},{"1":"Junior","2":"1994.110"},{"1":"Pleno","2":"3002.106"},{"1":"Pleno","2":"2998.646"},{"1":"Pleno","2":"3006.203"},{"1":"Senior","2":"3998.151"},{"1":"Senior","2":"4007.259"},{"1":"Junior","2":"2002.991"},{"1":"Pleno","2":"2999.568"},{"1":"Junior","2":"2002.583"},{"1":"Junior","2":"1999.671"},{"1":"Senior","2":"4005.962"},{"1":"Senior","2":"3994.435"},{"1":"Junior","2":"2000.329"},{"1":"Junior","2":"1999.934"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[6],"max":[6]},"pages":{}}}
  </script>
</div>
<p>Para trabalharmos com dados categóricos no <code>R</code> precisamos que estes estejam convertidos em fatores:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="regressão-linear-simples.html#cb139-1" aria-hidden="true" tabindex="-1"></a>cat_lm<span class="sc">$</span>Cargo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cat_lm<span class="sc">$</span>Cargo)</span></code></pre></div>
<p>Agora podemos ajustar o modelo de regressão linear utilizando o cargo de cada pessoa e seu respectivo salário:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="regressão-linear-simples.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Salario <span class="sc">~</span> Cargo, <span class="at">data =</span> cat_lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Salario ~ Cargo, data = cat_lm)
## 
## Coefficients:
## (Intercept)   CargoPleno  CargoSenior  
##        1998         1002         2004</code></pre>
<blockquote>
<p><span class="math inline">\(\color{skyblue}{\textbf{Questão 1:}}\)</span> Realize tal coisa</p>
</blockquote>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introdução-ao-machine-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regressão-linear-múltipla.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": false,
"toc_depth": 1
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
